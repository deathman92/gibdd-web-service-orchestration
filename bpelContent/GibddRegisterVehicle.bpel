<!-- GibddRegisterVehicle BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Tue May 31 20:05:28 MSK 2016 -->
<bpel:process name="GibddRegisterVehicle" targetNamespace="http://vlsu.ru/gibdd"
	suppressJoinFailure="yes" xmlns:tns="http://vlsu.ru/gibdd"
	xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
	xmlns:sig="http://vlsu.ru/signature" xmlns:reg="http://vlsu.ru/registervehicle"
	xmlns:insu="http://vlsu.ru/insurance" xmlns:ins="http://vlsu.ru/inspection"
	xmlns:bla="http://vlsu.ru/blacklistcheck" xmlns:cit="http://vlsu.ru/schema/citizen"
	xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:regi="http://vlsu.ru/schema/registration"
	xmlns:own="http://vlsu.ru/schema/owner">

	<!-- Import the client WSDL -->
	<bpel:import namespace="http://vlsu.ru/signature" location="SignatureWebService.wsdl"
		importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import namespace="http://vlsu.ru/registervehicle"
		location="RegisterWebService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import namespace="http://vlsu.ru/insurance" location="InsuranceWebService.wsdl"
		importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import namespace="http://vlsu.ru/inspection"
		location="InspectionWebService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import namespace="http://vlsu.ru/blacklistcheck"
		location="BlackListCheckWebService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import location="GibddRegisterVehicleArtifacts.wsdl"
		namespace="http://vlsu.ru/gibdd" importType="http://schemas.xmlsoap.org/wsdl/" />

	<!-- ================================================================= -->
	<!-- PARTNERLINKS -->
	<!-- List of services participating in this BPEL process -->
	<!-- ================================================================= -->
	<bpel:partnerLinks>
		<!-- The 'client' role represents the requester of this service. -->
		<bpel:partnerLink name="innerService"
			partnerLinkType="tns:GibddRegisterVehicle" myRole="GibddRegisterVehicleProvider" />
		<bpel:partnerLink name="blackListService"
			partnerLinkType="tns:BlackListCheckPLT" partnerRole="BlackListCheckType"></bpel:partnerLink>
		<bpel:partnerLink name="ispectionService"
			partnerLinkType="tns:InspectionPLT" partnerRole="InspectionType"></bpel:partnerLink>
		<bpel:partnerLink name="isuranceService"
			partnerLinkType="tns:InsurancePLT" partnerRole="InsuranceType"></bpel:partnerLink>
		<bpel:partnerLink name="registerService"
			partnerLinkType="tns:RegisterVehiclePLT" partnerRole="RegisterVehicleType"></bpel:partnerLink>
		<bpel:partnerLink name="signatureService"
			partnerLinkType="tns:SignaturePLT" partnerRole="SignatureType"></bpel:partnerLink>
	</bpel:partnerLinks>

	<!-- ================================================================= -->
	<!-- VARIABLES -->
	<!-- List of messages and XML documents used within this BPEL process -->
	<!-- ================================================================= -->
	<bpel:variables>
		<!-- Reference to the message passed as input during initiation -->
		<bpel:variable name="request" messageType="tns:GibddRegisterVehicleRequest" />

		<!-- Reference to the message that will be returned to the requester -->
		<bpel:variable name="response" messageType="tns:GibddRegisterVehicleResponse" />
		<bpel:variable name="fault" messageType="tns:GibddRegisterVehicleFault"></bpel:variable>
		<bpel:variable name="checkCitReq" messageType="bla:CheckCitizenRequest"></bpel:variable>
		<bpel:variable name="checkCitResp" messageType="bla:CheckCitizenResponse"></bpel:variable>
		<bpel:variable name="findRegCertReq"
			messageType="reg:FindRegistrationCertificateRequest"></bpel:variable>
		<bpel:variable name="findRegCertResp"
			messageType="reg:FindRegistrationCertificateResponse"></bpel:variable>
		<bpel:variable name="checkInspReq" messageType="ins:CheckInspectionRequest"></bpel:variable>
		<bpel:variable name="checkInspResp" messageType="ins:CheckInspectionResponse"></bpel:variable>
		<bpel:variable name="regVehReq" messageType="reg:RegisterVehicleRequest"></bpel:variable>
		<bpel:variable name="regVehResp" messageType="reg:RegisterVehicleResponse"></bpel:variable>
		<bpel:variable name="checkVehReq" messageType="bla:CheckVehicleRequest"></bpel:variable>
		<bpel:variable name="checkVehResp" messageType="bla:CheckVehicleResponse"></bpel:variable>
        <bpel:variable name="genSignReq" messageType="sig:GenerateSignatureRequest"></bpel:variable>
        <bpel:variable name="genSignResp" messageType="sig:GenerateSignatureResponse"></bpel:variable>
        <bpel:variable name="getInsReq" messageType="insu:getInsuranceRequest"></bpel:variable>
        <bpel:variable name="getInsResp" messageType="insu:getInsuranceResponse"></bpel:variable>
    </bpel:variables>

	<!-- ================================================================= -->
	<!-- ORCHESTRATION LOGIC -->
	<!-- Set of activities coordinating the flow of messages across the -->
	<!-- services integrated within this business process -->
	<!-- ================================================================= -->
	<bpel:sequence name="MainSequence">

		<!-- Receive input from requester. Note: This maps to operation defined 
			in GibddRegisterVehicle.wsdl -->
		<bpel:receive name="ReceiveRequest" partnerLink="innerService"
			portType="tns:GibddRegisterVehicle" operation="GibddRegisterVehicle"
			createInstance="yes" variable="request" />

		<!-- Generate reply to synchronous request -->

		<bpel:assign validate="no" name="AssignCheckCitizenRequest">
			<bpel:copy>
				<bpel:from>
					<bpel:literal xml:space="preserve">
						<bla:checkCitizenRequest xmlns:bla="http://vlsu.ru/blacklistcheck"
						xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
							<citizen xmlns:cit="http://vlsu.ru/schema/citizen"
						xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
								<cit:firstname>cit:firstname</cit:firstname>
								<cit:middlename>cit:middlename</cit:middlename>
								<cit:lastname>cit:lastname</cit:lastname>
								<cit:gender>cit:gender</cit:gender>
								<cit:birthday>cit:birthday</cit:birthday>
								<cit:birth_place>cit:birth_place</cit:birth_place>
								<cit:passport>
									<cit:series>cit:series</cit:series>
									<cit:number>cit:number</cit:number>
									<cit:issue_date>cit:issue_date</cit:issue_date>
									<cit:issued_by>cit:issued_by</cit:issued_by>
									<cit:registration>
										<cit:region>cit:region</cit:region>
										<cit:district>cit:district</cit:district>
										<cit:city>cit:city</cit:city>
										<cit:address>cit:address</cit:address>
										<cit:date>cit:date</cit:date>
									</cit:registration>
								</cit:passport>
							</citizen>
						</bla:checkCitizenRequest>
					</bpel:literal>
				</bpel:from>
				<bpel:to part="CheckCitizenRequest" variable="checkCitReq"></bpel:to>
			</bpel:copy>
			<bpel:copy>
				<bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:citizen/cit:firstname]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:firstname]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy><bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:citizen/cit:middlename]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:middlename]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy><bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:lastname]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:lastname]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:gender]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:gender]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birthday]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birthday]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birth_place]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birth_place]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:series]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:series]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:number]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:number]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issue_date]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issue_date]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issued_by]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issued_by]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
                </bpel:from>
                <bpel:to part="CheckCitizenRequest" variable="checkCitReq">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            
        </bpel:assign>
        <bpel:invoke name="InvokeCheckCitizen" partnerLink="blackListService" operation="CheckCitizen" portType="bla:BlackListCheck" inputVariable="checkCitReq" outputVariable="checkCitResp"></bpel:invoke>
        <bpel:if name="IfCheckCitizen">
            <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$checkCitResp.CheckCitizenResponse/result/result = "false"]]></bpel:condition>
            <bpel:flow name="Flow"><bpel:sequence name="RegCertSequence">
                    <bpel:assign validate="no" name="AssignFindReqCert">
                    <bpel:copy>
                        <bpel:from>
                            <bpel:literal xml:space="preserve">
                            	<reg:RegisterVehicleRequest xmlns:reg="http://vlsu.ru/registervehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
									<citizen xmlns:cit="http://vlsu.ru/schema/citizen" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
										<cit:firstname>cit:firstname</cit:firstname>
										<cit:middlename>cit:middlename</cit:middlename>
										<cit:lastname>cit:lastname</cit:lastname>
										<cit:gender>cit:gender</cit:gender>
										<cit:birthday>cit:birthday</cit:birthday>
										<cit:birth_place>cit:birth_place</cit:birth_place>
										<cit:passport>
											<cit:series>cit:series</cit:series>
											<cit:number>cit:number</cit:number>
											<cit:issue_date>cit:issue_date</cit:issue_date>
											<cit:issued_by>cit:issued_by</cit:issued_by>
											<cit:registration>
												<cit:region>cit:region</cit:region>
												<cit:district>cit:district</cit:district>
												<cit:city>cit:city</cit:city>
												<cit:address>cit:address</cit:address>
												<cit:date>cit:date</cit:date>
											</cit:registration>
										</cit:passport>
									</citizen>
									<vehicle_pass xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
										<veh:vin>veh:vin</veh:vin>
										<veh:model>veh:model</veh:model>
										<veh:type>veh:type</veh:type>
										<veh:category>veh:category</veh:category>
										<veh:built_year>veh:built_year</veh:built_year>
										<veh:engine_number>veh:engine_number</veh:engine_number>
										<veh:chassis_number>veh:chassis_number</veh:chassis_number>
										<veh:body_number>veh:body_number</veh:body_number>
										<veh:body_color>veh:body_color</veh:body_color>
									</vehicle_pass>
								</reg:RegisterVehicleRequest>
                            </bpel:literal>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:firstname]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:firstname]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:middlename]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:middlename]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:lastname]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:lastname]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:gender]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:gender]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birthday]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birthday]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birth_place]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birth_place]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:series]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:series]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:number]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:number]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issue_date]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issue_date]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issued_by]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issued_by]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:vin]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:vin]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:model]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:model]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:type]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:type]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:category]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:category]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:built_year]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:built_year]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:engine_number]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:engine_number]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:chassis_number]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:chassis_number]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_number]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_number]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_color]]></bpel:query>
                        </bpel:from>
                        <bpel:to part="FindRegistrationCertificateRequest" variable="findRegCertReq">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_color]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                </bpel:assign>
                    <bpel:invoke name="InvokeFindRegCert" partnerLink="registerService" operation="FindRegistrationCertificate" portType="reg:RegisterVehicle" inputVariable="findRegCertReq" outputVariable="findRegCertResp"></bpel:invoke>
                    
                    <bpel:if name="IfFindRegCert"><bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$findRegCertResp.FindRegistrationCertificateResponse/result = "true"]]></bpel:condition>
                        <bpel:assign validate="no" name="AssignResponse">
                        	<bpel:copy>
				                <bpel:from>
				                    <bpel:literal xml:space="preserve">
				                   		<tns:GibddVehicleRegisterResponse xmlns:tns="http://vlsu.ru/gibdd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
											<tns:registration_certificate xmlns:reg="http://vlsu.ru/schema/registration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
												<reg:registration_number>reg:registration_number
												</reg:registration_number>
												<reg:issue_place>reg:issue_place</reg:issue_place>
												<reg:issue_date>reg:issue_date</reg:issue_date>
												<reg:owner xmlns:own="http://vlsu.ru/schema/owner" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
													<own:firstname>own:firstname</own:firstname>
													<own:middlename>own:middlename</own:middlename>
													<own:lastname>own:lastname</own:lastname>
													<own:region>own:region</own:region>
													<own:district>own:district</own:district>
													<own:city>own:city</own:city>
													<own:address>own:address</own:address>
												</reg:owner>
												<reg:vehicle xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
													<veh:vin>veh:vin</veh:vin>
													<veh:model>veh:model</veh:model>
													<veh:type>veh:type</veh:type>
													<veh:category>veh:category</veh:category>
													<veh:built_year>veh:built_year</veh:built_year>
													<veh:engine_number>veh:engine_number</veh:engine_number>
													<veh:chassis_number>veh:chassis_number</veh:chassis_number>
													<veh:body_number>veh:body_number</veh:body_number>
													<veh:body_color>veh:body_color</veh:body_color>
												</reg:vehicle>
											</tns:registration_certificate>
										</tns:GibddVehicleRegisterResponse>
				                    </bpel:literal>
				                </bpel:from>
				                <bpel:to part="GibddRegisterVehicleResponse" variable="response"></bpel:to>
				            </bpel:copy>
				            <bpel:copy>
				    			<bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                        <![CDATA[registration_certificate/registration_number]]>
                                    </bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:registration_number]]></bpel:query>
                                </bpel:to>
							</bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/issue_place]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:issue_place]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/issue_date]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:issue_date]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/firstname]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:firstname]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/middlename]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:middlename]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/lastname]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:lastname]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/region]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:region]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/district]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:district]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/city]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:city]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/address]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:address]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:vin]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:vin]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:model]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:model]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:type]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:type]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:category]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:category]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:built_year]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:built_year]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:engine_number]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:engine_number]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:chassis_number]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:chassis_number]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:body_number]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:body_number]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="FindRegistrationCertificateResponse" variable="findRegCertResp">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:body_color]]></bpel:query>
                                </bpel:from>
                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:body_color]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:else>
                            <bpel:sequence><bpel:assign validate="no" name="AssignCheckInsp">
                                <bpel:copy>
                                    <bpel:from>
                                        <bpel:literal xml:space="preserve">
                                        	<ins:CheckInspectionRequest xmlns:ins="http://vlsu.ru/inspection" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
												<vehicle xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
													<veh:vin>veh:vin</veh:vin>
													<veh:model>veh:model</veh:model>
													<veh:type>veh:type</veh:type>
													<veh:category>veh:category</veh:category>
													<veh:built_year>veh:built_year</veh:built_year>
													<veh:engine_number>veh:engine_number</veh:engine_number>
													<veh:chassis_number>veh:chassis_number</veh:chassis_number>
													<veh:body_number>veh:body_number</veh:body_number>
													<veh:body_color>veh:body_color</veh:body_color>
												</vehicle>
											</ins:CheckInspectionRequest>
                                        </bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq"></bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:vin]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:vin]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:model]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:model]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:type]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:type]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:category]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:category]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:built_year]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:built_year]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:engine_number]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:engine_number]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:chassis_number]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:chassis_number]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_number]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:body_number]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_color]]></bpel:query>
                                    </bpel:from>
                                    <bpel:to part="CheckInspectionRequest" variable="checkInspReq">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:body_color]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                            </bpel:assign>
                                <bpel:invoke name="InvokeCheckInsp" partnerLink="ispectionService" operation="CheckInspection" portType="ins:Inspection" inputVariable="checkInspReq" outputVariable="checkInspResp"></bpel:invoke>
                                <bpel:if name="IfCheckInsp">
                                    <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$checkInspResp.CheckInspectionResponse/result = "true"]]></bpel:condition>
                                    <bpel:sequence>
                                        <bpel:assign validate="no" name="AssignRegVeh">
	                                        <bpel:copy>
	                                            <bpel:from>
	                                                <bpel:literal xml:space="preserve">
	                                                	<reg:RegisterVehicleRequest xmlns:reg="http://vlsu.ru/registervehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
															<citizen xmlns:cit="http://vlsu.ru/schema/citizen" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																<cit:firstname>cit:firstname</cit:firstname>
																<cit:middlename>cit:middlename</cit:middlename>
																<cit:lastname>cit:lastname</cit:lastname>
																<cit:gender>cit:gender</cit:gender>
																<cit:birthday>cit:birthday</cit:birthday>
																<cit:birth_place>cit:birth_place</cit:birth_place>
																<cit:passport>
																	<cit:series>cit:series</cit:series>
																	<cit:number>cit:number</cit:number>
																	<cit:issue_date>cit:issue_date</cit:issue_date>
																	<cit:issued_by>cit:issued_by</cit:issued_by>
																	<cit:registration>
																		<cit:region>cit:region</cit:region>
																		<cit:district>cit:district</cit:district>
																		<cit:city>cit:city</cit:city>
																		<cit:address>cit:address</cit:address>
																		<cit:date>cit:date</cit:date>
																	</cit:registration>
																</cit:passport>
															</citizen>
															<vehicle_pass xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																<veh:vin>veh:vin</veh:vin>
																<veh:model>veh:model</veh:model>
																<veh:type>veh:type</veh:type>
																<veh:category>veh:category</veh:category>
																<veh:built_year>veh:built_year</veh:built_year>
																<veh:engine_number>veh:engine_number</veh:engine_number>
																<veh:chassis_number>veh:chassis_number</veh:chassis_number>
																<veh:body_number>veh:body_number</veh:body_number>
																<veh:body_color>veh:body_color</veh:body_color>
															</vehicle_pass>
														</reg:RegisterVehicleRequest>
	                                                </bpel:literal>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq"></bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:firstname]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:firstname]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:middlename]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:middlename]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:lastname]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:lastname]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:gender]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:gender]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birthday]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birthday]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birth_place]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birth_place]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:series]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:series]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:number]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:number]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issue_date]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issue_date]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issued_by]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issued_by]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:vin]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:vin]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:model]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:model]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:type]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:type]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:category]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:category]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:built_year]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:built_year]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:engine_number]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:engine_number]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:chassis_number]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:chassis_number]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_number]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_number]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
	                                        <bpel:copy>
	                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_color]]></bpel:query>
	                                            </bpel:from>
	                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
	                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_color]]></bpel:query>
	                                            </bpel:to>
	                                        </bpel:copy>
                                    	</bpel:assign>
                                        <bpel:invoke name="InvokeRegVeh" partnerLink="registerService" operation="RegisterVehicle" portType="reg:RegisterVehicle" inputVariable="regVehReq" outputVariable="regVehResp"></bpel:invoke>
                                        <bpel:assign validate="no" name="AssignResponse">
                                            <bpel:copy>
                                                <bpel:from>
                                                    <bpel:literal xml:space="preserve">
                                                    	<tns:GibddVehicleRegisterResponse xmlns:tns="http://vlsu.ru/gibdd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
															<tns:registration_certificate xmlns:reg="http://vlsu.ru/schema/registration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																<reg:registration_number>reg:registration_number
																</reg:registration_number>
																<reg:issue_place>reg:issue_place</reg:issue_place>
																<reg:issue_date>reg:issue_date</reg:issue_date>
																<reg:owner xmlns:own="http://vlsu.ru/schema/owner" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																	<own:firstname>own:firstname</own:firstname>
																	<own:middlename>own:middlename</own:middlename>
																	<own:lastname>own:lastname</own:lastname>
																	<own:region>own:region</own:region>
																	<own:district>own:district</own:district>
																	<own:city>own:city</own:city>
																	<own:address>own:address</own:address>
																</reg:owner>
																<reg:vehicle xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																	<veh:vin>veh:vin</veh:vin>
																	<veh:model>veh:model</veh:model>
																	<veh:type>veh:type</veh:type>
																	<veh:category>veh:category</veh:category>
																	<veh:built_year>veh:built_year</veh:built_year>
																	<veh:engine_number>veh:engine_number</veh:engine_number>
																	<veh:chassis_number>veh:chassis_number</veh:chassis_number>
																	<veh:body_number>veh:body_number</veh:body_number>
																	<veh:body_color>veh:body_color</veh:body_color>
																</reg:vehicle>
															</tns:registration_certificate>
														</tns:GibddVehicleRegisterResponse>
													</bpel:literal>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response"></bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/registration_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:registration_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/issue_place]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:issue_place]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/issue_date]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:issue_date]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/firstname]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:firstname]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/middlename]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:middlename]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/lastname]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:lastname]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/region]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:region]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/district]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:district]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/city]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:city]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/address]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:address]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:vin]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:vin]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:model]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:model]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:type]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:type]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:category]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:category]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:built_year]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:built_year]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:engine_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:engine_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:chassis_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:chassis_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:body_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:body_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:body_color]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:body_color]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                        </bpel:assign>
                                    </bpel:sequence>
                                    <bpel:else>
                                        <bpel:sequence>
                                            <bpel:assign validate="no" name="AssignCheckVeh">
                                            <bpel:copy>
                                                <bpel:from>
                                                    <bpel:literal xml:space="preserve">
                                                    	<bla:checkVehicleRequest xmlns:bla="http://vlsu.ru/blacklistcheck" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
															<vehicle_pass xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																<veh:vin>veh:vin</veh:vin>
																<veh:model>veh:model</veh:model>
																<veh:type>veh:type</veh:type>
																<veh:category>veh:category</veh:category>
																<veh:built_year>veh:built_year</veh:built_year>
																<veh:engine_number>veh:engine_number</veh:engine_number>
																<veh:chassis_number>veh:chassis_number</veh:chassis_number>
																<veh:body_number>veh:body_number</veh:body_number>
																<veh:body_color>veh:body_color</veh:body_color>
															</vehicle_pass>
														</bla:checkVehicleRequest>
                                                    </bpel:literal>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq"></bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:vin]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:vin]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:model]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:model]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:type]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:type]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:category]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:category]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:built_year]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:built_year]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:engine_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:engine_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:chassis_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:chassis_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:body_number]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_number]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="CheckInspectionResponse" variable="checkInspResp">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle/veh:body_color]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="CheckVehicleRequest" variable="checkVehReq">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_color]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                        </bpel:assign>
                                            <bpel:invoke name="InvokeCheckVeh" partnerLink="blackListService" operation="CheckVehicle" portType="bla:BlackListCheck" inputVariable="checkVehReq" outputVariable="checkVehResp"></bpel:invoke>
                                            <bpel:if name="IfCheckVeh">
                                                <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$checkVehResp.CheckVehicleResponse/result/result = "false"]]></bpel:condition>
                                                <bpel:sequence>
                                                    <bpel:assign validate="no" name="AssignRegVeh">
                                                    	<bpel:copy>
				                                            <bpel:from>
				                                                <bpel:literal xml:space="preserve">
				                                                	<reg:RegisterVehicleRequest xmlns:reg="http://vlsu.ru/registervehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																		<citizen xmlns:cit="http://vlsu.ru/schema/citizen" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																			<cit:firstname>cit:firstname</cit:firstname>
																			<cit:middlename>cit:middlename</cit:middlename>
																			<cit:lastname>cit:lastname</cit:lastname>
																			<cit:gender>cit:gender</cit:gender>
																			<cit:birthday>cit:birthday</cit:birthday>
																			<cit:birth_place>cit:birth_place</cit:birth_place>
																			<cit:passport>
																				<cit:series>cit:series</cit:series>
																				<cit:number>cit:number</cit:number>
																				<cit:issue_date>cit:issue_date</cit:issue_date>
																				<cit:issued_by>cit:issued_by</cit:issued_by>
																				<cit:registration>
																					<cit:region>cit:region</cit:region>
																					<cit:district>cit:district</cit:district>
																					<cit:city>cit:city</cit:city>
																					<cit:address>cit:address</cit:address>
																					<cit:date>cit:date</cit:date>
																				</cit:registration>
																			</cit:passport>
																		</citizen>
																		<vehicle_pass xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																			<veh:vin>veh:vin</veh:vin>
																			<veh:model>veh:model</veh:model>
																			<veh:type>veh:type</veh:type>
																			<veh:category>veh:category</veh:category>
																			<veh:built_year>veh:built_year</veh:built_year>
																			<veh:engine_number>veh:engine_number</veh:engine_number>
																			<veh:chassis_number>veh:chassis_number</veh:chassis_number>
																			<veh:body_number>veh:body_number</veh:body_number>
																			<veh:body_color>veh:body_color</veh:body_color>
																		</vehicle_pass>
																	</reg:RegisterVehicleRequest>
				                                                </bpel:literal>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq"></bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:firstname]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:firstname]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:middlename]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:middlename]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:lastname]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:lastname]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:gender]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:gender]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birthday]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birthday]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birth_place]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:birth_place]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:series]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:series]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:number]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:number]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issue_date]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issue_date]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issued_by]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:issued_by]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:vin]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:vin]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:model]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:model]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:type]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:type]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:category]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:category]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:built_year]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:built_year]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:engine_number]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:engine_number]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:chassis_number]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:chassis_number]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_number]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_number]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
				                                        <bpel:copy>
				                                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_color]]></bpel:query>
				                                            </bpel:from>
				                                            <bpel:to part="RegisterVehicleRequest" variable="regVehReq">
				                                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[vehicle_pass/veh:body_color]]></bpel:query>
				                                            </bpel:to>
				                                        </bpel:copy>
                                                    </bpel:assign>
                                                    <bpel:invoke name="InvokeRegVeh" partnerLink="registerService" operation="RegisterVehicle" portType="reg:RegisterVehicle" inputVariable="regVehReq" outputVariable="regVehResp"></bpel:invoke>
			                                        <bpel:assign validate="no" name="AssignResponse">
			                                            <bpel:copy>
			                                                <bpel:from>
			                                                    <bpel:literal xml:space="preserve">
			                                                    	<tns:GibddVehicleRegisterResponse xmlns:tns="http://vlsu.ru/gibdd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																		<tns:registration_certificate xmlns:reg="http://vlsu.ru/schema/registration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																			<reg:registration_number>reg:registration_number
																			</reg:registration_number>
																			<reg:issue_place>reg:issue_place</reg:issue_place>
																			<reg:issue_date>reg:issue_date</reg:issue_date>
																			<reg:owner xmlns:own="http://vlsu.ru/schema/owner" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																				<own:firstname>own:firstname</own:firstname>
																				<own:middlename>own:middlename</own:middlename>
																				<own:lastname>own:lastname</own:lastname>
																				<own:region>own:region</own:region>
																				<own:district>own:district</own:district>
																				<own:city>own:city</own:city>
																				<own:address>own:address</own:address>
																			</reg:owner>
																			<reg:vehicle xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
																				<veh:vin>veh:vin</veh:vin>
																				<veh:model>veh:model</veh:model>
																				<veh:type>veh:type</veh:type>
																				<veh:category>veh:category</veh:category>
																				<veh:built_year>veh:built_year</veh:built_year>
																				<veh:engine_number>veh:engine_number</veh:engine_number>
																				<veh:chassis_number>veh:chassis_number</veh:chassis_number>
																				<veh:body_number>veh:body_number</veh:body_number>
																				<veh:body_color>veh:body_color</veh:body_color>
																			</reg:vehicle>
																		</tns:registration_certificate>
																	</tns:GibddVehicleRegisterResponse>
																</bpel:literal>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response"></bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/registration_number]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:registration_number]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/issue_place]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:issue_place]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/issue_date]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:issue_date]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/firstname]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:firstname]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/middlename]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:middlename]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/lastname]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:lastname]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/region]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:region]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/district]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:district]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/city]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:city]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/owner/address]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:owner/own:address]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:vin]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:vin]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:model]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:model]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:type]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:type]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:category]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:category]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:built_year]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:built_year]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:engine_number]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:engine_number]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:chassis_number]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:chassis_number]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:body_number]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:body_number]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                            <bpel:copy>
			                                                <bpel:from part="RegisterVehicleResponse" variable="regVehResp">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[registration_certificate/vehicle/veh:body_color]]></bpel:query>
			                                                </bpel:from>
			                                                <bpel:to part="GibddRegisterVehicleResponse" variable="response">
			                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:registration_certificate/regi:vehicle/veh:body_color]]></bpel:query>
			                                                </bpel:to>
			                                            </bpel:copy>
			                                        </bpel:assign>
                                                </bpel:sequence>
                                                <bpel:else>
                                                    <bpel:sequence>
                                                        <bpel:assign validate="no" name="AssignFault">
                                                        <bpel:copy>
                                                            <bpel:from>
                                                                <bpel:literal xml:space="preserve">
                                                                	<tns:GibddVehicleRegisterFault xmlns:tns="http://vlsu.ru/gibdd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
										                           		<tns:message>
										                          				Vehicle in blacklist!
										                          			</tns:message>
										                           	</tns:GibddVehicleRegisterFault>
									                           	</bpel:literal>
                                                            </bpel:from>
                                                            <bpel:to part="GibddRegisterVehicleFault" variable="fault"></bpel:to>
                                                        </bpel:copy>
                                                    </bpel:assign>
                                                        <bpel:throw name="Throw" faultName="tns:GibddRegisterVehicleFault" faultVariable="fault"></bpel:throw>
                                                    </bpel:sequence>
                                                </bpel:else>
                                            </bpel:if>
                                        </bpel:sequence>
                                    </bpel:else>
                                </bpel:if>
                            
                            </bpel:sequence>
                        </bpel:else>
                    
                    </bpel:if>
                </bpel:sequence><bpel:sequence name="InsuranceSequence">
                    <bpel:assign validate="no" name="AssignGenSign">
                    <bpel:copy>
                        <bpel:from>
                            <bpel:literal xml:space="preserve">
                            	<sig:GenerateSignatureRequest xmlns:sig="http://vlsu.ru/signature" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                            		<sig:citizen xmlns:cit="http://vlsu.ru/schema/citizen" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
										<cit:firstname>cit:firstname</cit:firstname>
										<cit:middlename>cit:middlename</cit:middlename>
										<cit:lastname>cit:lastname</cit:lastname>
										<cit:gender>cit:gender</cit:gender>
										<cit:birthday>cit:birthday</cit:birthday>
										<cit:birth_place>cit:birth_place</cit:birth_place>
										<cit:passport>
											<cit:series>cit:series</cit:series>
											<cit:number>cit:number</cit:number>
											<cit:issue_date>cit:issue_date</cit:issue_date>
											<cit:issued_by>cit:issued_by</cit:issued_by>
											<cit:registration>
												<cit:region>cit:region</cit:region>
												<cit:district>cit:district</cit:district>
												<cit:city>cit:city</cit:city>
												<cit:address>cit:address</cit:address>
												<cit:date>cit:date</cit:date>
											</cit:registration>
										</cit:passport>
									</sig:citizen>
									<sig:vehicle xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
										<veh:vin>veh:vin</veh:vin>
										<veh:model>veh:model</veh:model>
										<veh:type>veh:type</veh:type>
										<veh:category>veh:category</veh:category>
										<veh:built_year>veh:built_year</veh:built_year>
										<veh:engine_number>veh:engine_number</veh:engine_number>
										<veh:chassis_number>veh:chassis_number</veh:chassis_number>
										<veh:body_number>veh:body_number</veh:body_number>
										<veh:body_color>veh:body_color</veh:body_color>
									</sig:vehicle>
                            	</sig:GenerateSignatureRequest> 
                            </bpel:literal>
                        </bpel:from>
                        <bpel:to part="GenerateSignatureRequest" variable="genSignReq"></bpel:to>
                    </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:firstname]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:firstname]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:middlename]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:middlename]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:lastname]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:lastname]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:gender]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:gender]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birthday]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:birthday]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:birth_place]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:birth_place]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:series]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:series]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:number]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:number]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issue_date]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:issue_date]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:issued_by]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:issued_by]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:registration/cit:region]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:registration/cit:district]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:registration/cit:city]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:registration/cit:address]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:citizen/cit:passport/cit:registration/cit:date]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:vin]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:vin]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:model]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:model]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:type]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:type]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:category]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:category]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:built_year]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:built_year]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:engine_number]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:engine_number]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:chassis_number]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:chassis_number]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_number]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:body_number]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="GibddRegisterVehicleRequest" variable="request">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:vehicle_pass/veh:body_color]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="GenerateSignatureRequest" variable="genSignReq">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[sig:vehicle/veh:body_color]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeGenSign" partnerLink="signatureService" operation="GenerateSignature" portType="sig:Signature" inputVariable="genSignReq" outputVariable="genSignResp"></bpel:invoke>
                    <bpel:assign validate="no" name="AssignGetIns">
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal xml:space="preserve">
                                	<ins:getInsuranceRequest xmlns:ins="http://vlsu.ru/inspection">
                                		<ins:signature>ins:signature</ins:signature>
                                		<ins:citizen xmlns:cit="http://vlsu.ru/schema/citizen" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
											<cit:firstname>cit:firstname</cit:firstname>
											<cit:middlename>cit:middlename</cit:middlename>
											<cit:lastname>cit:lastname</cit:lastname>
											<cit:gender>cit:gender</cit:gender>
											<cit:birthday>cit:birthday</cit:birthday>
											<cit:birth_place>cit:birth_place</cit:birth_place>
											<cit:passport>
												<cit:series>cit:series</cit:series>
												<cit:number>cit:number</cit:number>
												<cit:issue_date>cit:issue_date</cit:issue_date>
												<cit:issued_by>cit:issued_by</cit:issued_by>
												<cit:registration>
													<cit:region>cit:region</cit:region>
													<cit:district>cit:district</cit:district>
													<cit:city>cit:city</cit:city>
													<cit:address>cit:address</cit:address>
													<cit:date>cit:date</cit:date>
												</cit:registration>
											</cit:passport>
										</ins:citizen>
										<ins:vehicle xmlns:veh="http://vlsu.ru/schema/vehicle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
											<veh:vin>veh:vin</veh:vin>
											<veh:model>veh:model</veh:model>
											<veh:type>veh:type</veh:type>
											<veh:category>veh:category</veh:category>
											<veh:built_year>veh:built_year</veh:built_year>
											<veh:engine_number>veh:engine_number</veh:engine_number>
											<veh:chassis_number>veh:chassis_number</veh:chassis_number>
											<veh:body_number>veh:body_number</veh:body_number>
											<veh:body_color>veh:body_color</veh:body_color>
										</ins:vehicle>
                                	</ins:getInsuranceRequest>
                                </bpel:literal>
                            </bpel:from>
                            <bpel:to part="getInsuranceRequest" variable="getInsReq"></bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeGetIns" partnerLink="isuranceService" operation="getInsurance" portType="insu:Insurance" inputVariable="getInsReq" outputVariable="getInsResp">
                    </bpel:invoke>
                </bpel:sequence></bpel:flow>
            <bpel:else>
                <bpel:sequence>
                    <bpel:assign validate="no" name="AssignFault">
                    <bpel:copy>
                        <bpel:from>
                            <bpel:literal xml:space="preserve">
                            	<tns:GibddVehicleRegisterFault xmlns:tns="http://vlsu.ru/gibdd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                            		<tns:message>
                           				Citizen in blacklist!
                           			</tns:message>
                            	</tns:GibddVehicleRegisterFault>
                            </bpel:literal>
                        </bpel:from>
                        <bpel:to part="GibddRegisterVehicleFault" variable="fault"></bpel:to>
                    </bpel:copy>
                </bpel:assign>
                    <bpel:throw name="Throw" faultName="tns:GibddRegisterVehicleFault" faultVariable="fault"></bpel:throw>
                </bpel:sequence>
            </bpel:else>
        </bpel:if>
        
        <bpel:reply name="ReplyResponse" 
               partnerLink="innerService"
               portType="tns:GibddRegisterVehicle"
               operation="GibddRegisterVehicle" variable="response"/>
    </bpel:sequence>
</bpel:process>

